RewriteEngine On

# If accessing the root, redirect to frontend/index.html
RewriteRule ^$ frontend/index.html [L]

# API requests go to backend
RewriteRule ^backend(/.*)?$ backend$1 [L]

# Static assets in frontend directory
RewriteCond %{REQUEST_URI} !^/backend/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ frontend/$1 [L]

# If file doesn't exist in frontend directory, serve the SPA index
RewriteCond %{REQUEST_URI} !^/backend/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ frontend/index.html [L]

# API requests are handled by backend/.htaccess
